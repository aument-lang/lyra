#include <stdint.h>
#include "../insn.h"
#include "../comp.h"
#include "types.txt"
void lyra_insn_codegen(struct lyra_comp *c, struct lyra_insn *insn){
if(insn->type == LYRA_OP_MOV_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_MOV_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_i32(c,insn->right_operand.i32);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_MOV_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_f64(c,insn->right_operand.f64);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_MUL_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"au_value_mul(");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,",");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,")");
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_MUL_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"*");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_MUL_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"*");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_DIV_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"au_value_div(");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,",");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,")");
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_DIV_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"/");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_DIV_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"/");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_ADD_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"au_value_add(");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,",");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,")");
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_ADD_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"+");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_ADD_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"+");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_SUB_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"au_value_sub(");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,",");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,")");
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_SUB_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"-");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_SUB_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"-");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_MOD_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"au_value_mod(");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,",");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,")");
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_MOD_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"%");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_MOD_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"%");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_EQ_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"au_value_eq(");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,",");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,")");
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_EQ_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"==");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_EQ_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"==");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_NEQ_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"au_value_neq(");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,",");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,")");
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_NEQ_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"!=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_NEQ_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"!=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_LT_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"au_value_lt(");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,",");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,")");
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_LT_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"<");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_LT_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"<");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_GT_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"au_value_gt(");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,",");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,")");
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_GT_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,">");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_GT_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,">");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_LEQ_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"au_value_leq(");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,",");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,")");
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_LEQ_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"<=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_LEQ_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"<=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_GEQ_VAR) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"au_value_geq(");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,",");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,")");
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_GEQ_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,">=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_GEQ_F64) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,">=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_BOR_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"|");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_BXOR_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"^");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_BAND_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"&");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_BSHL_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,"<<");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
if(insn->type == LYRA_OP_BSHR_I32) {
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->dest_var);lyra_comp_print_str(c,"=");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->left_var);
lyra_comp_print_str(c,">>");
lyra_comp_print_str(c,"v");lyra_comp_print_isize(c,insn->right_operand.var);
lyra_comp_print_str(c,";");
return;
}
}
